!!! 5

-# from: https://github.com/jameslutley/haml-html5-boilerplate
-# see repo for full commented-out options

-# useful: http://webdesigntutsplus.s3.amazonaws.com/tuts/312_bs/My-Bootstrap-Site-NAVBAR/navbar-examples.html

%html.no-js{:lang => "en"}
  %head
    %meta{ :charset => "utf-8" }
    %meta{'http-equiv' => 'X-UA-Compatible', :content => 'IE=edge,chrome=1'}
    
    %title= (@title) ? @title : configatron.app_name
    
    %meta{ :name => "description", :content => (@title) ? @title : configatron.app_name }
    %meta{ :name => "viewport", :content => "width=device-width, initial-scale=1" }
    -# %meta{ :name => "apple-mobile-web-app-capable", :content => "yes" }

    %meta{ :property => "fb:app_id", :content => "295556897221526" }
    %meta{ :property => "og:site_name", :content => "Fnnny.com" }
    %meta{ :property => "og:url", :content => request.url }
    
    - if @item
      %meta{ :property => "og:type", :content => "article"}
      %meta{ :property => "og:image", :content => "http://res.cloudinary.com/fnnny/image/upload/c_thumb,g_face,h_75,w_75/#{@item.id}.png" }
    
    - if @description
      %meta{ :property => "og:description", :content => @description }
      
    - if @title
      %meta{ :property => "og:title", :content => @title }

    -# RSS
    -# ==========================================================================
    -# %link{:rel => "alternate", :type => "application/rss+xml", :title => "RSS", :href => "http://feeds.feedburner.com/FEEDNAME"}
    
    
    %link{:rel => "icon", :type => "image/png", :href => "/assets/fnnny_16.png"}
    %link{:rel => "apple-touch-icon-precomposed", :sizes => "114x114", :href => "/assets/fnnny_114.png"}
          
    <link href='http://fonts.googleapis.com/css?family=Maiden+Orange&text=fnnny&effect=neon' rel='stylesheet' type='text/css'>
    
    -# <link rel="stylesheet" href="/jquery.scrollz.css">
    = stylesheet_link_tag "application", :media => "all"
    
    %script{:src => "//ajax.googleapis.com/ajax/libs/jquery/1.8.2/jquery.min.js"}
    
    -# - if @mobile
    :javascript
      var addToHomeConfig = {
        returningVisitor: true,
        animationIn: 'bubble',
        animationOut: 'drop',
        expire: 0
      };
      
      // When ready...
      window.addEventListener("load",function() {
        // Set a timeout...
        setTimeout(function(){
          // Hide the address bar!
          window.scrollTo(0, 1);
        }, 0);
      });
      
    = javascript_include_tag 'a2h'
    = csrf_meta_tags
    
  %body
    
    #fb-root
    <script src="http://connect.facebook.net/en_US/all.js"></script>
    
    -# - if @mobile
    - top_nav_class = 'navbar-static-top'
    = javascript_include_tag 'fnnny_mobile'
    -# - else
    -#   - top_nav_class = 'navbar-fixed-top'
      
    -# from: http://www.w3resource.com/twitter-bootstrap/navbar-tutorial.php
    #wrap
      -# .navbar-fixed-top  <---- for top, stays put while content scrolls behind
      -# .navbar-static-top <----for top, but scrolls away
      .navbar.navbar-inverse{:class => top_nav_class}
        
        :css
          .navbar-text { margin-bottom: 0; line-height: 30px; }
          .navbar .divider-vertical { height: 30px; margin: 0 9px; }
          .navbar .nav > li > a {
            float: none;
            padding: 5px 15px 5px;
            color: #777777;
            text-decoration: none;
            text-shadow: 0 1px 0 #ffffff;
          }
          .navbar .nav .dropdown-toggle .caret { margin-top: 8px; }
          
        .navbar-inner{:style => 'height: 30px; min-height: 30px;'}
          .container
            
            -# = link_to configatron.app_name.downcase, root_path, :class => 'font-effect-neon', :style => 'margin-left: 7px;'
            %a{:href => root_path}
              -# %img{:src => "/assets/fnnny_16.png", :style => 'margin: 10px 0 0 8px;'}
              -# = link_to configatron.app_name.downcase, root_path, :class => 'font-effect-neon', :style => 'margin-left: 7px;'
              -# %i.icon-home.icon-white{:style => 'margin: 8px 0 0 8px;'}
              %i.icon-fire.icon-white{:style => 'margin: 8px 0 0 8px;'}
            
            - if user_signed_in?
              
              %ul.nav.pull-right.top-nav
                %li
                  %a{:href => new_item_path, :rel => "tooltip", :title => "Add item"}
                    %i.icon-plus.icon-white
                    
                %li
                  %a{:href => tags_path, :rel => "tooltip", :title => "Tags"}
                    %i.icon-tags.icon-white
                    
                %li
                  %a{:href => people_path, :rel => "tooltip", :title => "People"}
                    %i.icon-user.icon-white
                    
                %li.dropdown
                  %a{:href => "#", :class => "dropdown-toggle", :'data-toggle' => "dropdown"}
                    %i.icon-cog.icon-white
                    %b.caret
                    
                  %ul.dropdown-menu
                    %li= link_to 'View profile', person_path(current_user)
                    %li= link_to 'Edit profile', edit_user_registration_path
                    %li= link_to "Log Out", destroy_user_session_path, :method => :delete
                    %li= link_to 'Get bookmarklet', bookmarklet_path
                    
                    - if signed_in? && current_user.admin?
                      %li= link_to "Admin", admin_path, :style => 'color:red;'
                      
                -# %li
                -#   = link_to '(o)', destroy_user_session_path, :method => :delete
                -#   -# %a{:href => destroy_user_session_path, :rel => "tooltip", :title => "Log out"}
                -#   -#                     %i.icon-off.icon-white
                    
                    
              :javascript
                $(function() {
                  $('.top-nav').tooltip({
                    selector: "a[rel=tooltip]", placement: 'bottom'
                  });
                });
                
            - else
              
              %ul.nav.pull-right
                %li
                  = link_to t(:log_in).humanize, omniauth_authorize_path(User, 'facebook'), :style => 'margin-top: 0px;'
                
              .pull-right{:style => 'margin: -2px 5px 0 0;'}
                = link_to t(:sign_up).humanize, omniauth_authorize_path(User, 'facebook'), :class => "btn btn-mini btn-success"
              
      .container
        
        = yield
        
        -# -# eventually this should probably be in the header. and it should definitely be fixed.
        -# - if has_messages = false
        -#   .alert.fade.in
        -#     %a.close{:"data-dismiss" => "alert"} &times;
        -#     <strong>Warning!</strong> Best check yo self, you're not looking too good.
        -#   
        -#   :javascript
        -#     $('.alert').bind('closed', function () {
        -#       alert('phu');
        -#       // post back to app to mark message as read.
        -#     })
        
        
        
    -# - unless @mobile
    -#   = javascript_include_tag 'fnnny'
      
    = humane_flash_messages.html_safe
    
    -#
    -# Asynchronous Google Analytics
    -# Change UA-XXXXX-X to be your site's ID
    -# mathiasbynens.be/notes/async-analytics-snippet
    :javascript
      var _gaq=[['_setAccount','UA-XXXXX-X'],['_trackPageview']];
      (function(d,t){var g=d.createElement(t),s=d.getElementsByTagName(t)[0];
      g.src=('https:'==location.protocol?'//ssl':'//www')+'.google-analytics.com/ga.js';
      s.parentNode.insertBefore(g,s)}(document,'script'));
      